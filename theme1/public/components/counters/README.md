# Counter Displays with Carousel Component

A standalone counter displays component with automatic carousel rotation for OBS Studio overlays with real-time Streamer.bot integration.

## Features

- **4 Configurable Counters**: Independent value, label, and visibility control
- **Automatic Carousel**: 5-second rotation through visible counters
- **Pure CSS Animations**: Smooth transitions and infinite scroll
- **Manual Navigation**: Click indicators to jump to specific slides
- **Hover Controls**: Pause/resume on mouse hover
- **Real-time Sync**: Values update in carousel as they change
- **Dynamic Visibility**: Show/hide counters without breaking carousel
- **Streamer.bot Integration**: Connects to Streamer.bot for live data
- **Clone Synchronization**: Seamless infinite scroll with data sync

## Files

- `counters.html` - Main HTML structure with hidden counter elements and carousel
- `counters.css` - Complete styling with CSS animations and responsive design
- `counters.js` - JavaScript functionality including CarouselManager system
- `index.html` - Simple entry point for OBS
- `demo.html` - Interactive demo with comprehensive test controls
- `README.md` - This documentation

## Usage

### OBS Studio Integration

1. **Browser Source URL**: `http://localhost:3000/components/counters/`
2. **Resolution**: 600x300 (recommended) or custom
3. **Custom CSS**: Not required (styles included in component)

### Direct Access

- **Main Component**: `http://localhost:3000/components/counters/counters.html`
- **Demo Page**: `http://localhost:3000/components/counters/demo.html`
- **Simple Entry Point**: `http://localhost:3000/components/counters/index.html`

### Streamer.bot Integration

The component automatically connects to Streamer.bot at `ws://127.0.0.1:8080/` and listens for these global variables:

#### Counter Variables

**Counter 1:**
- `counter1` - Counter value (number)
- `counter1label` - Counter label (string)
- `counter1toggle` - Show/hide counter (boolean)

**Counter 2:**
- `counter2` - Counter value
- `counter2label` - Counter label
- `counter2toggle` - Show/hide counter

**Counter 3:**
- `counter3` - Counter value
- `counter3label` - Counter label
- `counter3toggle` - Show/hide counter

**Counter 4:**
- `counter4` - Counter value
- `counter4label` - Counter label
- `counter4toggle` - Show/hide counter

#### Example Streamer.bot Actions

**Update Counter Value:**
```csharp
// C# code for Streamer.bot action
CPH.SetGlobalVar("counter1", "1247");
CPH.SetGlobalVar("counter1label", "Followers");
```

**Toggle Counter Visibility:**
```csharp
// Hide counter 2
CPH.SetGlobalVar("counter2toggle", "false");

// Show counter 3
CPH.SetGlobalVar("counter3toggle", "true");
```

**Increment Counter:**
```csharp
// Get current value and increment
string currentStr = CPH.GetGlobalVar<string>("counter1", false);
int current = int.Parse(currentStr ?? "0");
CPH.SetGlobalVar("counter1", (current + 1).ToString());
```

## Carousel System

The component features a sophisticated carousel system with the following capabilities:

### Animation System
- **5-Second Intervals**: Each slide displays for 5 seconds
- **Smooth Transitions**: CSS-based animations with easing
- **Infinite Scroll**: Seamless looping using cloned first slide
- **Dynamic Timing**: Animation duration adjusts to number of visible counters

### Navigation Features
- **Auto-rotation**: Automatic progression through slides
- **Manual Control**: Click indicator dots to jump to slides
- **Hover Pause**: Animation pauses when mouse hovers over carousel
- **Resume Delay**: 10-second delay before resuming after manual navigation

### Slide Management
- **Dynamic Slides**: Only visible counters create slides
- **Real-time Rebuild**: Carousel rebuilds when counter visibility changes
- **Data Sync**: Counter values update in carousel immediately
- **Clone Sync**: Infinite scroll clone stays synchronized with original

## Debug Functions

Open browser console and use these functions:

```javascript
// Debug component state
debugCounters();

// Debug carousel state
debugCarousel();

// Test counter values
testCounterValues();

// Test counter labels
testCounterLabels();

// Test visibility
testCounterVisibility();

// Manual slide navigation
testSlideNavigation(2); // Go to slide 3 (0-indexed)

// Toggle autoplay
toggleAutoplay();
```

## Component Architecture

### Counter Management
- **Hidden Elements**: Original counter elements serve as data source
- **Carousel Display**: Large format counter displays in carousel slides
- **Data Synchronization**: Changes to hidden elements update carousel immediately
- **Visibility Control**: Counters can be shown/hidden without breaking carousel

### CSS Animation System
```css
/* Dynamic keyframes generated by JavaScript */
@keyframes carousel-auto-rotate {
    0% { transform: translateX(0%); }
    20% { transform: translateX(0%); }      /* Hold slide 1 */
    25% { transform: translateX(-100%); }   /* Transition */
    45% { transform: translateX(-100%); }   /* Hold slide 2 */
    /* ... continues for all slides */
    100% { transform: translateX(-400%); }  /* Infinite scroll to clone */
}
```

### State Management
```javascript
CarouselManager.state = {
    currentSlide: 0,          // Current visible slide index
    totalSlides: 4,           // Number of visible counters
    slides: [...],            // Slide configuration array
    autoplayTimer: null,      // Animation timer
    intervalDuration: 5000,   // 5 seconds per slide
    isPaused: false,          // Pause state
    animationStartTime: null  // For indicator sync
}
```

## Customization

### Colors and Theming

Edit CSS variables in `counters.css`:

```css
:root {
    --primary: #00d4ff;     /* Indicators and borders */
    --secondary: #ff3366;   /* Counter values */
    --border-color: rgba(255, 255, 255, 0.2);  /* Component borders */
    --glass-bg: rgba(0, 0, 0, 0.4);            /* Background */
}
```

### Counter Display Sizes

Adjust counter appearance:

```css
.counter-value-large {
    font-size: 96px;        /* Large carousel display */
}

.counter-label-large {
    font-size: 32px;        /* Large carousel labels */
}

.counter-value {
    font-size: 56px;        /* Original counter display */
}
```

### Carousel Timing

Modify carousel behavior:

```css
:root {
    --carousel-duration: 25s;  /* Total cycle time for 5 slides */
}
```

```javascript
// In JavaScript
this.state.intervalDuration = 5000;  // 5 seconds per slide
```

### Responsive Breakpoints

The component includes responsive design:

```css
@media (max-width: 768px) {
    .counter-value-large { font-size: 72px; }
    .carousel-container { height: 150px; }
}

@media (max-width: 480px) {
    .counter-value-large { font-size: 56px; }
    .carousel-container { height: 120px; }
}
```

## Browser Compatibility

- **OBS Studio**: Chromium-based (recommended)
- **Chrome/Edge**: Full support including CSS animations
- **Firefox**: Full support with hardware acceleration
- **Safari**: Full support with minor CSS differences

## Performance Optimization

### CSS Animation Benefits
- **Hardware Acceleration**: GPU-accelerated transforms
- **Smooth 60fps**: CSS animations maintain consistent framerate
- **Low CPU Usage**: More efficient than JavaScript animations
- **Battery Friendly**: Reduced power consumption on laptops

### Memory Management
- **Component Size**: ~5-8MB total memory usage
- **DOM Elements**: Minimal elements with efficient updates
- **Event Cleanup**: Proper cleanup prevents memory leaks

## Troubleshooting

### Carousel Issues

**Problem**: Carousel not starting
**Solution**:
- Check that at least one counter is visible
- Verify JavaScript console for errors
- Ensure iframe is fully loaded

**Problem**: Indicators not syncing
**Solution**:
- Check CSS animation support
- Verify timer synchronization
- Use debug functions to check state

### Data Sync Issues

**Problem**: Carousel shows old values
**Solution**:
- Check clone synchronization
- Verify data attribute targeting
- Use `debugCarousel()` to check sync

**Problem**: Counter visibility not working
**Solution**:
- Check boolean value parsing
- Verify counter element IDs
- Use `testCounterVisibility()` for testing

### Performance Issues

**Problem**: Animations stuttering
**Solution**:
- Enable hardware acceleration in browser
- Reduce other browser tabs/extensions
- Check for high CPU usage applications

**Problem**: Memory usage growing
**Solution**:
- Refresh overlay page periodically
- Check for JavaScript errors in console
- Verify proper event cleanup

## Advanced Usage

### Custom Counter Types

The component can be extended to support different counter types:

```javascript
// Add custom counter configuration
this.config.customCounter = {
    valueVariable: 'customValue',
    labelVariable: 'customLabel',
    toggleVariable: 'customToggle',
    defaultValue: 0,
    defaultLabel: 'Custom',
    defaultVisible: true
};
```

### Multiple Instances

Run multiple counter components with different configurations:

```html
<!-- Gaming stats -->
<iframe src="/components/counters/?preset=gaming"></iframe>

<!-- Social stats -->
<iframe src="/components/counters/?preset=social"></iframe>
```

### External API Integration

Extend the component to fetch data from external APIs:

```javascript
// Example: Fetch follower count from API
async function updateFromAPI() {
    const response = await fetch('/api/followers');
    const data = await response.json();
    this.updateCounterValue('counter1', data.followers);
}
```

## Configuration Files

### Counter Defaults

Default configuration in component:

```javascript
const config = {
    counter1: {
        valueVariable: 'counter1',
        labelVariable: 'counter1label',
        toggleVariable: 'counter1toggle',
        defaultValue: 0,
        defaultLabel: 'Counter 1',
        defaultVisible: true
    }
    // ... additional counters
};
```

### Streamer.bot Variables

Required global variables in Streamer.bot:

| Variable | Type | Description |
|----------|------|-------------|
| `counter1` | String/Number | Counter 1 value |
| `counter1label` | String | Counter 1 label |
| `counter1toggle` | Boolean/String | Counter 1 visibility |
| `counter2` | String/Number | Counter 2 value |
| `counter2label` | String | Counter 2 label |
| `counter2toggle` | Boolean/String | Counter 2 visibility |
| `counter3` | String/Number | Counter 3 value |
| `counter3label` | String | Counter 3 label |
| `counter3toggle` | Boolean/String | Counter 3 visibility |
| `counter4` | String/Number | Counter 4 value |
| `counter4label` | String | Counter 4 label |
| `counter4toggle` | Boolean/String | Counter 4 visibility |

## Summary

**Component Status**: âœ… **Fully Functional**
**Dependencies**: Streamer.bot (optional), Modern Browser with CSS Animation support
**Use Cases**: Stream overlays, counter displays, statistics rotation, event counting

The counter displays component provides a professional, animated carousel system for showcasing multiple counters with smooth transitions and real-time data updates.